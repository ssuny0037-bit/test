<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>예제</title>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-/xUj+3OJ+Y3b1hY3f2s6e7kKp1y5u7Jv4q0h1m2r3s4=" crossorigin="anonymous"></script>
  <script src="main.js" defer></script>
  <link rel="stylesheet" href="style.css">

</head>

<body>

  <section class="content-section--fullpage">
    <div class="content-section__headline-container">
      <h1 class="content-section__headline">NEW BRAND</h1>
    </div>

    <span class="scroll-indicator">
      <span class="scroll-indicator__line"></span>
      Scroll
    </span>
  </section>
  <section class="content-section--fullpage"></section>

  <script>
    var headline = document.getElementsByClassName('content-section__headline-container');
var headlineOffset = headline[0].offsetTop;
var letters = headline[0].innerText.split('');
letters = letters.filter(function(letter) {
  return letter !== ' ' && letter !== '\n' ? letter : false;
});
var tweenDistance = getRandomArbitrary(200, 400);
var topDistance = 0;
var movement = 0;
var elements = [];

function getRandomArbitrary(min, max) {
  return Math.floor(Math.random() * (max - min)) + min;
}

function move(element, distance) {
  var translate3d = 'translate3d(0, ' + distance + 'px, 0)';
  element.style['-webkit-transform'] = translate3d;
  element.style['-moz-transform'] = translate3d;
  element.style['-ms-transform'] = translate3d;
  element.style['-o-transform'] = translate3d;
  element.style.transform = translate3d;
};

function moveY(element, distance) {
  var translate3d = 'translateY(' + distance + '%)';
  element.style['-webkit-transform'] = translate3d;
  element.style['-moz-transform'] = translate3d;
  element.style['-ms-transform'] = translate3d;
  element.style['-o-transform'] = translate3d;
  element.style.transform = translate3d;
};

function fadeOut(element, scrollDistance, tweenDistance) {
  element.style.opacity = (tweenDistance - scrollDistance) / tweenDistance;
}

function tweenHeight(element, scrollDistance, tweenDistance, initialHeight) {
  element.style.height = (((tweenDistance - scrollDistance) / tweenDistance) * initialHeight) + 'px';
}

letters.forEach(function(letter) {
  var element = document.createElement('span');
  element.innerText = letter;
  element.dataset.speed = Math.random(0, 1).toFixed(2);
  headline[0].appendChild(element);
  elements.push(element);
});

window.addEventListener('scroll', function (event) {
  var scrollIndicator = document.getElementsByClassName('scroll-indicator');
  var scrollIndicatorLine = document.getElementsByClassName('scroll-indicator__line');
  topDistance = window.pageYOffset;
  movement = topDistance*2;

  fadeOut(scrollIndicator[0], topDistance, 150);
  tweenHeight(scrollIndicatorLine[0], topDistance, 100, 25);
  
  elements.forEach(function(element) {
    movement = -(topDistance * element.dataset.speed);
    move(element, movement);
    fadeOut(element, topDistance, tweenDistance);
  });
});

$(function(){
  // h1과 스팬(각 글자)을 모두 선택
  var $targets = $('.content-section__headline, .content-section__headline-container span');
  if (!$targets.length) return;

  // 숨겨져 있으면 보이게 함 (필요 시 제거)
  $('.content-section__headline').css('opacity', 1);

  var hue = 0, last = null;
  var speed = 0.02; // 조절: 작게 하면 느려짐

  function tick(now){
    if (last === null) last = now;
    var dt = now - last;
    last = now;
    hue = (hue + dt * speed) % 360;
    $targets.css('color', 'hsl(' + Math.round(hue) + ', 100%, 50%)');
    requestAnimationFrame(tick);
  }

  requestAnimationFrame(tick);
});
  </script>

  </body>